{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.areHeadersContradicting = void 0;\n\nvar areHeadersContradicting = function areHeadersContradicting(b1, b2) {\n  var earlierBlock = b1;\n  var laterBlock = b2;\n  var higherMaxHeightPreviouslyForged = earlierBlock.asset.maxHeightPreviouslyForged > laterBlock.asset.maxHeightPreviouslyForged;\n  var sameMaxHeightPreviouslyForged = earlierBlock.asset.maxHeightPreviouslyForged === laterBlock.asset.maxHeightPreviouslyForged;\n  var higherMaxHeightPrevoted = earlierBlock.asset.maxHeightPrevoted > laterBlock.asset.maxHeightPrevoted;\n  var sameMaxHeightPrevoted = earlierBlock.asset.maxHeightPrevoted === laterBlock.asset.maxHeightPrevoted;\n  var higherHeight = earlierBlock.height > laterBlock.height;\n\n  if (higherMaxHeightPreviouslyForged || sameMaxHeightPreviouslyForged && higherMaxHeightPrevoted || sameMaxHeightPreviouslyForged && sameMaxHeightPrevoted && higherHeight) {\n    var _ref = [laterBlock, earlierBlock];\n    earlierBlock = _ref[0];\n    laterBlock = _ref[1];\n  }\n\n  if (!earlierBlock.generatorPublicKey.equals(laterBlock.generatorPublicKey)) {\n    return false;\n  }\n\n  if (earlierBlock.id.equals(laterBlock.id)) {\n    return false;\n  }\n\n  if (earlierBlock.asset.maxHeightPrevoted === laterBlock.asset.maxHeightPrevoted && earlierBlock.height >= laterBlock.height) {\n    return true;\n  }\n\n  if (earlierBlock.height > laterBlock.asset.maxHeightPreviouslyForged) {\n    return true;\n  }\n\n  if (earlierBlock.asset.maxHeightPrevoted > laterBlock.asset.maxHeightPrevoted) {\n    return true;\n  }\n\n  return false;\n};\n\nexports.areHeadersContradicting = areHeadersContradicting;","map":{"version":3,"sources":["../src/header_contradicting.ts"],"names":[],"mappings":";;;;;;;AAgBO,IAAM,uBAAuB,GAAG,SAA1B,uBAA0B,CAAC,EAAD,EAAkB,EAAlB,EAA8C;AACpF,MAAI,YAAY,GAAG,EAAnB;AACA,MAAI,UAAU,GAAG,EAAjB;AACA,MAAM,+BAA+B,GACpC,YAAY,CAAC,KAAb,CAAmB,yBAAnB,GAA+C,UAAU,CAAC,KAAX,CAAiB,yBADjE;AAEA,MAAM,6BAA6B,GAClC,YAAY,CAAC,KAAb,CAAmB,yBAAnB,KAAiD,UAAU,CAAC,KAAX,CAAiB,yBADnE;AAEA,MAAM,uBAAuB,GAC5B,YAAY,CAAC,KAAb,CAAmB,iBAAnB,GAAuC,UAAU,CAAC,KAAX,CAAiB,iBADzD;AAEA,MAAM,qBAAqB,GAC1B,YAAY,CAAC,KAAb,CAAmB,iBAAnB,KAAyC,UAAU,CAAC,KAAX,CAAiB,iBAD3D;AAEA,MAAM,YAAY,GAAG,YAAY,CAAC,MAAb,GAAsB,UAAU,CAAC,MAAtD;;AACA,MACC,+BAA+B,IAC9B,6BAA6B,IAAI,uBADlC,IAEC,6BAA6B,IAAI,qBAAjC,IAA0D,YAH5D,EAIE;AAAA,eAC4B,CAAC,UAAD,EAAa,YAAb,CAD5B;AACA,IAAA,YADA;AACc,IAAA,UADd;AAED;;AAED,MAAI,CAAC,YAAY,CAAC,kBAAb,CAAgC,MAAhC,CAAuC,UAAU,CAAC,kBAAlD,CAAL,EAA4E;AAC3E,WAAO,KAAP;AACA;;AAED,MAAI,YAAY,CAAC,EAAb,CAAgB,MAAhB,CAAuB,UAAU,CAAC,EAAlC,CAAJ,EAA2C;AAC1C,WAAO,KAAP;AACA;;AACD,MACC,YAAY,CAAC,KAAb,CAAmB,iBAAnB,KAAyC,UAAU,CAAC,KAAX,CAAiB,iBAA1D,IACA,YAAY,CAAC,MAAb,IAAuB,UAAU,CAAC,MAFnC,EAGE;AAID,WAAO,IAAP;AACA;;AAED,MAAI,YAAY,CAAC,MAAb,GAAsB,UAAU,CAAC,KAAX,CAAiB,yBAA3C,EAAsE;AACrE,WAAO,IAAP;AACA;;AAED,MAAI,YAAY,CAAC,KAAb,CAAmB,iBAAnB,GAAuC,UAAU,CAAC,KAAX,CAAiB,iBAA5D,EAA+E;AAC9E,WAAO,IAAP;AACA;;AACD,SAAO,KAAP;AACA,CA7CM;;AAAM,OAAA,CAAA,uBAAA,GAAuB,uBAAvB","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.areHeadersContradicting = void 0;\nconst areHeadersContradicting = (b1, b2) => {\n    let earlierBlock = b1;\n    let laterBlock = b2;\n    const higherMaxHeightPreviouslyForged = earlierBlock.asset.maxHeightPreviouslyForged > laterBlock.asset.maxHeightPreviouslyForged;\n    const sameMaxHeightPreviouslyForged = earlierBlock.asset.maxHeightPreviouslyForged === laterBlock.asset.maxHeightPreviouslyForged;\n    const higherMaxHeightPrevoted = earlierBlock.asset.maxHeightPrevoted > laterBlock.asset.maxHeightPrevoted;\n    const sameMaxHeightPrevoted = earlierBlock.asset.maxHeightPrevoted === laterBlock.asset.maxHeightPrevoted;\n    const higherHeight = earlierBlock.height > laterBlock.height;\n    if (higherMaxHeightPreviouslyForged ||\n        (sameMaxHeightPreviouslyForged && higherMaxHeightPrevoted) ||\n        (sameMaxHeightPreviouslyForged && sameMaxHeightPrevoted && higherHeight)) {\n        [earlierBlock, laterBlock] = [laterBlock, earlierBlock];\n    }\n    if (!earlierBlock.generatorPublicKey.equals(laterBlock.generatorPublicKey)) {\n        return false;\n    }\n    if (earlierBlock.id.equals(laterBlock.id)) {\n        return false;\n    }\n    if (earlierBlock.asset.maxHeightPrevoted === laterBlock.asset.maxHeightPrevoted &&\n        earlierBlock.height >= laterBlock.height) {\n        return true;\n    }\n    if (earlierBlock.height > laterBlock.asset.maxHeightPreviouslyForged) {\n        return true;\n    }\n    if (earlierBlock.asset.maxHeightPrevoted > laterBlock.asset.maxHeightPrevoted) {\n        return true;\n    }\n    return false;\n};\nexports.areHeadersContradicting = areHeadersContradicting;\n//# sourceMappingURL=header_contradicting.js.map"]},"metadata":{},"sourceType":"script"}
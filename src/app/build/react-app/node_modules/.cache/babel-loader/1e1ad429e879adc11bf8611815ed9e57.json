{"ast":null,"code":"var scErrors = require('sc-errors');\n\nvar InvalidActionError = scErrors.InvalidActionError;\n\nvar Response = function Response(socket, id) {\n  this.socket = socket;\n  this.id = id;\n  this.sent = false;\n};\n\nResponse.prototype._respond = function (responseData, options) {\n  if (this.sent) {\n    throw new InvalidActionError('Response ' + this.id + ' has already been sent');\n  } else {\n    this.sent = true;\n    this.socket.sendObject(responseData, options);\n  }\n};\n\nResponse.prototype.end = function (data, options) {\n  if (this.id) {\n    var responseData = {\n      rid: this.id\n    };\n\n    if (data !== undefined) {\n      responseData.data = data;\n    }\n\n    this._respond(responseData, options);\n  }\n};\n\nResponse.prototype.error = function (error, data, options) {\n  if (this.id) {\n    var err = scErrors.dehydrateError(error);\n    var responseData = {\n      rid: this.id,\n      error: err\n    };\n\n    if (data !== undefined) {\n      responseData.data = data;\n    }\n\n    this._respond(responseData, options);\n  }\n};\n\nResponse.prototype.callback = function (error, data, options) {\n  if (error) {\n    this.error(error, data, options);\n  } else {\n    this.end(data, options);\n  }\n};\n\nmodule.exports.Response = Response;","map":{"version":3,"sources":["/home/lisk/doomonlisk/node_modules/socketcluster-server/response.js"],"names":["scErrors","require","InvalidActionError","Response","socket","id","sent","prototype","_respond","responseData","options","sendObject","end","data","rid","undefined","error","err","dehydrateError","callback","module","exports"],"mappings":"AAAA,IAAIA,QAAQ,GAAGC,OAAO,CAAC,WAAD,CAAtB;;AACA,IAAIC,kBAAkB,GAAGF,QAAQ,CAACE,kBAAlC;;AAEA,IAAIC,QAAQ,GAAG,SAAXA,QAAW,CAAUC,MAAV,EAAkBC,EAAlB,EAAsB;AACnC,OAAKD,MAAL,GAAcA,MAAd;AACA,OAAKC,EAAL,GAAUA,EAAV;AACA,OAAKC,IAAL,GAAY,KAAZ;AACD,CAJD;;AAMAH,QAAQ,CAACI,SAAT,CAAmBC,QAAnB,GAA8B,UAAUC,YAAV,EAAwBC,OAAxB,EAAiC;AAC7D,MAAI,KAAKJ,IAAT,EAAe;AACb,UAAM,IAAIJ,kBAAJ,CAAuB,cAAc,KAAKG,EAAnB,GAAwB,wBAA/C,CAAN;AACD,GAFD,MAEO;AACL,SAAKC,IAAL,GAAY,IAAZ;AACA,SAAKF,MAAL,CAAYO,UAAZ,CAAuBF,YAAvB,EAAqCC,OAArC;AACD;AACF,CAPD;;AASAP,QAAQ,CAACI,SAAT,CAAmBK,GAAnB,GAAyB,UAAUC,IAAV,EAAgBH,OAAhB,EAAyB;AAChD,MAAI,KAAKL,EAAT,EAAa;AACX,QAAII,YAAY,GAAG;AACjBK,MAAAA,GAAG,EAAE,KAAKT;AADO,KAAnB;;AAGA,QAAIQ,IAAI,KAAKE,SAAb,EAAwB;AACtBN,MAAAA,YAAY,CAACI,IAAb,GAAoBA,IAApB;AACD;;AACD,SAAKL,QAAL,CAAcC,YAAd,EAA4BC,OAA5B;AACD;AACF,CAVD;;AAYAP,QAAQ,CAACI,SAAT,CAAmBS,KAAnB,GAA2B,UAAUA,KAAV,EAAiBH,IAAjB,EAAuBH,OAAvB,EAAgC;AACzD,MAAI,KAAKL,EAAT,EAAa;AACX,QAAIY,GAAG,GAAGjB,QAAQ,CAACkB,cAAT,CAAwBF,KAAxB,CAAV;AAEA,QAAIP,YAAY,GAAG;AACjBK,MAAAA,GAAG,EAAE,KAAKT,EADO;AAEjBW,MAAAA,KAAK,EAAEC;AAFU,KAAnB;;AAIA,QAAIJ,IAAI,KAAKE,SAAb,EAAwB;AACtBN,MAAAA,YAAY,CAACI,IAAb,GAAoBA,IAApB;AACD;;AAED,SAAKL,QAAL,CAAcC,YAAd,EAA4BC,OAA5B;AACD;AACF,CAdD;;AAgBAP,QAAQ,CAACI,SAAT,CAAmBY,QAAnB,GAA8B,UAAUH,KAAV,EAAiBH,IAAjB,EAAuBH,OAAvB,EAAgC;AAC5D,MAAIM,KAAJ,EAAW;AACT,SAAKA,KAAL,CAAWA,KAAX,EAAkBH,IAAlB,EAAwBH,OAAxB;AACD,GAFD,MAEO;AACL,SAAKE,GAAL,CAASC,IAAT,EAAeH,OAAf;AACD;AACF,CAND;;AAQAU,MAAM,CAACC,OAAP,CAAelB,QAAf,GAA0BA,QAA1B","sourcesContent":["var scErrors = require('sc-errors');\nvar InvalidActionError = scErrors.InvalidActionError;\n\nvar Response = function (socket, id) {\n  this.socket = socket;\n  this.id = id;\n  this.sent = false;\n};\n\nResponse.prototype._respond = function (responseData, options) {\n  if (this.sent) {\n    throw new InvalidActionError('Response ' + this.id + ' has already been sent');\n  } else {\n    this.sent = true;\n    this.socket.sendObject(responseData, options);\n  }\n};\n\nResponse.prototype.end = function (data, options) {\n  if (this.id) {\n    var responseData = {\n      rid: this.id\n    };\n    if (data !== undefined) {\n      responseData.data = data;\n    }\n    this._respond(responseData, options);\n  }\n};\n\nResponse.prototype.error = function (error, data, options) {\n  if (this.id) {\n    var err = scErrors.dehydrateError(error);\n\n    var responseData = {\n      rid: this.id,\n      error: err\n    };\n    if (data !== undefined) {\n      responseData.data = data;\n    }\n\n    this._respond(responseData, options);\n  }\n};\n\nResponse.prototype.callback = function (error, data, options) {\n  if (error) {\n    this.error(error, data, options);\n  } else {\n    this.end(data, options);\n  }\n};\n\nmodule.exports.Response = Response;\n"]},"metadata":{},"sourceType":"script"}
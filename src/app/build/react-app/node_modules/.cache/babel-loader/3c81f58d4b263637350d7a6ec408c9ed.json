{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/home/lisk/doomonlisk/src/app/build/react-app/node_modules/@babel/runtime/regenerator\");\n\nvar _asyncToGenerator = require(\"/home/lisk/doomonlisk/src/app/build/react-app/node_modules/@babel/runtime/helpers/asyncToGenerator\");\n\nvar _classCallCheck = require(\"/home/lisk/doomonlisk/src/app/build/react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/home/lisk/doomonlisk/src/app/build/react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar _get = require(\"/home/lisk/doomonlisk/src/app/build/react-app/node_modules/@babel/runtime/helpers/get\");\n\nvar _getPrototypeOf = require(\"/home/lisk/doomonlisk/src/app/build/react-app/node_modules/@babel/runtime/helpers/getPrototypeOf\");\n\nvar _inherits = require(\"/home/lisk/doomonlisk/src/app/build/react-app/node_modules/@babel/runtime/helpers/inherits\");\n\nvar _createSuper = require(\"/home/lisk/doomonlisk/src/app/build/react-app/node_modules/@babel/runtime/helpers/createSuper\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.IPCServer = void 0;\n\nvar axon = require(\"pm2-axon\");\n\nvar ipc_socket_1 = require(\"./ipc_socket\");\n\nvar IPCServer = /*#__PURE__*/function (_ipc_socket_1$IPCSock) {\n  _inherits(IPCServer, _ipc_socket_1$IPCSock);\n\n  var _super = _createSuper(IPCServer);\n\n  function IPCServer(options) {\n    var _this;\n\n    _classCallCheck(this, IPCServer);\n\n    _this = _super.call(this, options);\n    _this.pubSocket = axon.socket('pub', {});\n    _this.subSocket = axon.socket('pull', {});\n    return _this;\n  }\n\n  _createClass(IPCServer, [{\n    key: \"start\",\n    value: function () {\n      var _start = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this2 = this;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return _get(_getPrototypeOf(IPCServer.prototype), \"start\", this).call(this);\n\n              case 2:\n                _context.next = 4;\n                return new Promise(function (resolve, reject) {\n                  _this2.pubSocket.on('bind', resolve);\n\n                  _this2.pubSocket.on('error', reject);\n\n                  _this2.pubSocket.bind(_this2._eventPubSocketPath);\n                }).finally(function () {\n                  _this2.pubSocket.removeAllListeners('bind');\n\n                  _this2.pubSocket.removeAllListeners('error');\n                });\n\n              case 4:\n                _context.next = 6;\n                return new Promise(function (resolve, reject) {\n                  _this2.subSocket.on('bind', resolve);\n\n                  _this2.subSocket.on('error', reject);\n\n                  _this2.subSocket.bind(_this2._eventSubSocketPath);\n                }).finally(function () {\n                  _this2.subSocket.removeAllListeners('bind');\n\n                  _this2.subSocket.removeAllListeners('error');\n                });\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function start() {\n        return _start.apply(this, arguments);\n      }\n\n      return start;\n    }()\n  }]);\n\n  return IPCServer;\n}(ipc_socket_1.IPCSocket);\n\nexports.IPCServer = IPCServer;","map":{"version":3,"sources":["../../../src/controller/ipc/ipc_server.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAmBA,IAAA,IAAA,GAAA,OAAA,CAAA,UAAA,CAAA;;AAEA,IAAA,YAAA,GAAA,OAAA,CAAA,cAAA,CAAA;;IAEa,S;;;;;AACZ,qBAAmB,OAAnB,EAAgE;AAAA;;AAAA;;AAC/D,8BAAM,OAAN;AAEA,UAAK,SAAL,GAAiB,IAAI,CAAC,MAAL,CAAY,KAAZ,EAAmB,EAAnB,CAAjB;AACA,UAAK,SAAL,GAAiB,IAAI,CAAC,MAAL,CAAY,MAAZ,EAAoB,EAApB,CAAjB;AAJ+D;AAK/D;;;;;4EAEM;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,uBAGA,IAAI,OAAJ,CAAY,UAAC,OAAD,EAAU,MAAV,EAAoB;AACrC,kBAAA,MAAI,CAAC,SAAL,CAAe,EAAf,CAAkB,MAAlB,EAA0B,OAA1B;;AACA,kBAAA,MAAI,CAAC,SAAL,CAAe,EAAf,CAAkB,OAAlB,EAA2B,MAA3B;;AAEA,kBAAA,MAAI,CAAC,SAAL,CAAe,IAAf,CAAoB,MAAI,CAAC,mBAAzB;AACA,iBALK,EAKH,OALG,CAKK,YAAK;AACf,kBAAA,MAAI,CAAC,SAAL,CAAe,kBAAf,CAAkC,MAAlC;;AACA,kBAAA,MAAI,CAAC,SAAL,CAAe,kBAAf,CAAkC,OAAlC;AACA,iBARK,CAHA;;AAAA;AAAA;AAAA,uBAaA,IAAI,OAAJ,CAAY,UAAC,OAAD,EAAU,MAAV,EAAoB;AACrC,kBAAA,MAAI,CAAC,SAAL,CAAe,EAAf,CAAkB,MAAlB,EAA0B,OAA1B;;AACA,kBAAA,MAAI,CAAC,SAAL,CAAe,EAAf,CAAkB,OAAlB,EAA2B,MAA3B;;AAIA,kBAAA,MAAI,CAAC,SAAL,CAAe,IAAf,CAAoB,MAAI,CAAC,mBAAzB;AACA,iBAPK,EAOH,OAPG,CAOK,YAAK;AACf,kBAAA,MAAI,CAAC,SAAL,CAAe,kBAAf,CAAkC,MAAlC;;AACA,kBAAA,MAAI,CAAC,SAAL,CAAe,kBAAf,CAAkC,OAAlC;AACA,iBAVK,CAbA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;;EARuB,YAAA,CAAA,S;;AAA/B,OAAA,CAAA,SAAA,GAAA,SAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.IPCServer = void 0;\nconst axon = require(\"pm2-axon\");\nconst ipc_socket_1 = require(\"./ipc_socket\");\nclass IPCServer extends ipc_socket_1.IPCSocket {\n    constructor(options) {\n        super(options);\n        this.pubSocket = axon.socket('pub', {});\n        this.subSocket = axon.socket('pull', {});\n    }\n    async start() {\n        await super.start();\n        await new Promise((resolve, reject) => {\n            this.pubSocket.on('bind', resolve);\n            this.pubSocket.on('error', reject);\n            this.pubSocket.bind(this._eventPubSocketPath);\n        }).finally(() => {\n            this.pubSocket.removeAllListeners('bind');\n            this.pubSocket.removeAllListeners('error');\n        });\n        await new Promise((resolve, reject) => {\n            this.subSocket.on('bind', resolve);\n            this.subSocket.on('error', reject);\n            this.subSocket.bind(this._eventSubSocketPath);\n        }).finally(() => {\n            this.subSocket.removeAllListeners('bind');\n            this.subSocket.removeAllListeners('error');\n        });\n    }\n}\nexports.IPCServer = IPCServer;\n//# sourceMappingURL=ipc_server.js.map"]},"metadata":{},"sourceType":"script"}